<html><head><title>UVMC Command API Example - Factory</title><link rel="stylesheet" type="text/css" href="../../../styles/main.css"><script language=JavaScript src="../../../javascript/main.js"></script></head><body class="FramedContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 01-12-2008 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org --> 








 <!--TOP - START OF CONTENT-->
<div id=Content>


 <!--CONTENT index=0 -->
<div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle></h1><div class=CBody><p>This example demonstrates making UVM factory queries and setting type and instance overrides.&nbsp; The UVMC factory API mirrors the methods provided in UVM:</p><table border=0 cellspacing=0 cellpadding=0 class=CDescriptionList><tr><td class=CDLEntry>uvmc_print_factory</td><td class=CDLDescription>print the contents of the UVM factory</td></tr><tr><td class=CDLEntry>uvmc_find_factory_override</td><td class=CDLDescription>get the name of the type the factory would create given a requested type and context.</td></tr><tr><td class=CDLEntry>uvmc_debug_factory_create</td><td class=CDLDescription>print detailed information on how the factory arrives the type it returns given a requested type and a context.</td></tr><tr><td class=CDLEntry>uvmc_set_factory_type_override</td><td class=CDLDescription>set a type-wide override whereby all requests for a type will instead produce the override type for all instances of the requested type.</td></tr><tr><td class=CDLEntry>uvmc_set_factory_inst_override</td><td class=CDLDescription>set a instance override whereby a request for a type will instead produce the override type for all instances matching the given path.&nbsp; Glob and regular expressions are allowed.</td></tr></table><p>See the <a href="../../src/connect/sc/uvmc_commands-h.html#Factory" class=LGroup id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">Factory</a> command descriptions for more details.</p></div></div></div>




 <!--CONTENT index=1 -->
<div class="CClass"><div class=CTopic><h2 class=CTitle><a name="top" href="../../../uvmc/examples/commands/ex_factory.cpp">top</a></h2>

<!--START_ND_SUMMARY index=1-->
<div class=Summary><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=1 -->

<tr class="SClass"><td colspan=2 class=SEntry><a name="topSummary"  href="#top">top</a></td></tr>
<tr class=SMain><td colspan=2 class=SWideDescription>Our top-level SC module does the following</td></tr>
  <!-- index=2 -->

<tr class="SMethod SIndent1 SMarked"><td class=SEntry><a name="top.show_uvm_factorySummary"  href="#top.show_uvm_factory">show_uvm_factory</a></td><td class=SDescription>The <i>show_uvm_factory</i> thread will show usage of the UVMC factory commands. </td></tr>
  <!-- index=3 -->

<tr class="SGroup SIndent1"><td class=SEntry><a name="top.sc_mainSummary"  href="#top.sc_main">sc_main</a></td><td class=SDescription>Creates an instance of our <a href="#top" class=LClass id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">top</a> module then calls <i>sc_start</i> to start SC simulation.</td></tr></table></div></div><!--END_ND_SUMMARY-->
<div class=CBody><p>Our top-level SC module does the following</p><ul><li>Creates an instance of a generic <a href="../converters/consumer-cpp.html#consumer" class=LClass >consumer</a>.&nbsp; The consumer merely prints the transactions it receives side and sends them out its analysis port.</li><li>Spawn a thread function, <i>show_uvm_factory</i></li><li>Register the consumer&rsquo;s ports for UVMC connection.</li></ul><blockquote><pre>#include &quot;systemc.h&quot;
#include &quot;tlm.h&quot;
#include &lt;string&gt;
#include &lt;iostream&gt;

using namespace std;
using namespace sc_core;
using namespace tlm;

#include &quot;uvmc.h&quot;
#include &quot;uvmc_macros.h&quot;
using namespace uvmc;

#include &quot;consumer.cpp&quot;


SC_MODULE(top)
{
  consumer cons;

  SC_CTOR(top) : cons(&quot;consumer&quot;) {
    SC_THREAD(show_uvm_factory);
    uvmc_connect(cons.in,&quot;foo&quot;);
    uvmc_connect(cons.analysis_out,&quot;bar&quot;);
  }

  void show_uvm_factory();

};</pre></blockquote></div></div></div>




 <!--CONTENT index=2 -->
<div class="CMethod"><div class=CTopic><h3 class=CTitle><a name="top.show_uvm_factory" href="../../../uvmc/examples/commands/ex_factory.cpp">show_uvm_factory</a></h3><div class=CBody><p>The <i>show_uvm_factory</i> thread will show usage of the UVMC factory commands.&nbsp; In this example, we configure type and instance overrides to make the UVM factory create extensions to the default producer and scoreboard components.&nbsp; We call on <a href="../../src/connect/sc/uvmc_commands-h.html#uvmc_print_factory" class=LMethod id=link3 onMouseOver="ShowTip(event, 'tt3', 'link3')" onMouseOut="HideTip('tt3')">uvmc_print_factory</a> and <a href="../../src/connect/sc/uvmc_commands-h.html#uvmc_debug_factory_create" class=LMethod id=link4 onMouseOver="ShowTip(event, 'tt4', 'link4')" onMouseOut="HideTip('tt4')">uvmc_debug_factory_create</a> to confirm our settings, and we call ~uvmc_find_factory_override&gt; to confirm that our override has taken effect.</p><p>Note the use of the UVM_INFO and UVM_ERROR macros, which issue reports to UVM for filtering, formatting, and display.</p><blockquote><pre>void top::show_uvm_factory()
{
  string override;

  // print the factory before we do anything
  uvmc_print_factory();

  // what type would the factory give if we asked for a producer?
  override = uvmc_find_factory_override(&quot;producer&quot;,&quot;e.prod&quot;);

  UVMC_INFO(&quot;SHOW_FACTORY&quot;,
    (string(&quot;Factory override for type 'producer' &quot;) +
     + &quot;in context 'e.prod' is &quot; + override).c_str(),
     UVM_NONE,&quot;&quot;);

  // show how factory chooses what type it creates
  uvmc_debug_factory_create(&quot;producer&quot;,&quot;e.prod&quot;);

  // set a type and instance override
  uvmc_set_factory_type_override(&quot;producer&quot;,&quot;producer_ext&quot;,&quot;e.*&quot;);
  uvmc_set_factory_inst_override(&quot;scoreboard&quot;,&quot;scoreboard_ext&quot;,&quot;e.*&quot;);

  // print the factory after setting overrides
  uvmc_print_factory();

  uvmc_debug_factory_create(&quot;producer&quot;,&quot;e.prod&quot;);
  uvmc_debug_factory_create(&quot;scoreboard&quot;,&quot;e.sb&quot;);

  // NOW what type would the factory give if we asked for a producer?
  override = uvmc_find_factory_override(&quot;producer&quot;,&quot;e.prod&quot;);

  UVMC_INFO(&quot;SHOW_FACTORY&quot;,
    (string(&quot;Factory override for type 'producer' &quot;) +
     + &quot;with context 'e.prod' is &quot; + override).c_str(),
     UVM_NONE,&quot;&quot;);

  // What type would the factory give if we asked for a scoreboard?
  override = uvmc_find_factory_override(&quot;scoreboard&quot;,&quot;e.*&quot;);

  UVMC_INFO(&quot;SHOW_FACTORY&quot;,
    (string(&quot;Factory override for type 'scoreboard' &quot;) +
     + &quot;given a context 'e.*' is &quot; + override).c_str(),
     UVM_NONE,&quot;&quot;);
}</pre></blockquote></div></div></div>




 <!--CONTENT index=3 -->
<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="top.sc_main" href="../../../uvmc/examples/commands/ex_factory.cpp">sc_main</a></h3><div class=CBody><p>Creates an instance of our <a href="#top" class=LClass id=link5 onMouseOver="ShowTip(event, 'tt2', 'link5')" onMouseOut="HideTip('tt2')">top</a> module then calls <i>sc_start</i> to start SC simulation.</p><blockquote><pre>int sc_main(int argc, char* argv[])
{
  top t(&quot;top&quot;);
  sc_start();
  return 0;
}</pre></blockquote></div></div></div>

</div><!--Content-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CGroup>This API provides access to UVM&rsquo;s object and component factory.</div></div><div class=CToolTip id="tt2"><div class=CClass>Our top-level SC module does the following</div></div><div class=CToolTip id="tt3"><div class=CMethod>Prints the state of the UVM factory, including registered types, instance overrides, and type overrides.</div></div><div class=CToolTip id="tt4"><div class=CMethod>Display detailed information about the object type the UVM factory would create given a requested type and context, listing each override that was applied to arrive at the result.</div></div><!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>