<html><head><title>UVMC Command API Example - Configuration</title><link rel="stylesheet" type="text/css" href="../../../styles/main.css"><script language=JavaScript src="../../../javascript/main.js"></script></head><body class="FramedContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 01-12-2008 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org --> 








 <!--TOP - START OF CONTENT-->
<div id=Content>


 <!--CONTENT index=0 -->
<div class="CSection"><div class=CTopic id=MainTopic><h1 class=CTitle></h1>

<!--START_ND_SUMMARY index=0-->
<div class=Summary><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=0 -->

<tr class="SMain"><td class=SEntry><a name="UVMC_Command_API_Example-Configuration"  href="../../../uvmc/examples/commands/ex_config.cpp">UVMC Command API Example - Configuration</a></td><td class=SDescription>This example demonstrates usage the <a href="../../src/connect/sc/uvmc_commands-h.html#set_config" class=LGroup id=link1 onMouseOver="ShowTip(event, 'tt1', 'link1')" onMouseOut="HideTip('tt1')">set_config</a> and <a href="../../src/connect/sc/uvmc_commands-h.html#get_config" class=LGroup id=link2 onMouseOver="ShowTip(event, 'tt2', 'link2')" onMouseOut="HideTip('tt2')">get_config</a> portion of the UVMC Command API.</td></tr>
  <!-- index=1 -->

<tr class="SSMethod SMarked"><td class=SEntry><a name="prod_cfgSummary"  href="#prod_cfg">prod_cfg</a></td><td class=SDescription>The <i>prod_cfg</i> class is the configuration object we&rsquo;ll be sending to the producer component on the SV side. </td></tr>
  <!-- index=2 -->

<tr class="SSMethod"><td class=SEntry><a name="topSummary"  href="#top">top</a></td><td class=SDescription>Our top-level SC module does the following</td></tr>
  <!-- index=5 -->

<tr class="SSMethod SMarked"><td class=SEntry><a name="SC_MAINSummary"  href="#SC_MAIN">SC_MAIN</a></td><td class=SDescription>Creates an instance of our <a href="#top" class=LClass id=link3 onMouseOver="ShowTip(event, 'tt3', 'link3')" onMouseOut="HideTip('tt3')">top</a> module then calls <i>sc_start</i> to start SC simulation.</td></tr></table></div></div><!--END_ND_SUMMARY-->
<div class=CBody><p>This example demonstrates usage the <a href="../../src/connect/sc/uvmc_commands-h.html#set_config" class=LGroup id=link4 onMouseOver="ShowTip(event, 'tt1', 'link4')" onMouseOut="HideTip('tt1')">set_config</a> and <a href="../../src/connect/sc/uvmc_commands-h.html#get_config" class=LGroup id=link5 onMouseOver="ShowTip(event, 'tt2', 'link5')" onMouseOut="HideTip('tt2')">get_config</a> portion of the UVMC Command API.</p><p>For setting an object, a converter must be defined for the object being transferred.&nbsp; See <a href="../converters/README-txt.html#Converters" class=LSection id=link6 onMouseOver="ShowTip(event, 'tt4', 'link6')" onMouseOut="HideTip('tt4')">Converters</a> for how to do that.&nbsp; This requirement is most easily met using one of the <a href="../../src/connect/sc/uvmc_macros-h.html#UVMC_UTILS" class=LGeneric id=link7 onMouseOver="ShowTip(event, 'tt5', 'link7')" onMouseOut="HideTip('tt5')">UVMC_UTILS</a> or <a href="../../src/connect/sc/uvmc_macros-h.html#UVMC_CONVERT" class=LGeneric id=link8 onMouseOver="ShowTip(event, 'tt6', 'link8')" onMouseOut="HideTip('tt6')">UVMC_CONVERT</a> macros, which generate the converter specialization class.</p><p>uvmc_set_config - The 1st arg is the full path to the component(s) on whose behalf you are setting the configuration.&nbsp; If empty (&ldquo;&rdquo;), <i>uvm_top</i> is used.&nbsp; The 2nd argument is the path to the component target(s) whose configuration value you want to set, relative to the path given by the 1st argument.&nbsp; The 3rd argument is the name of the configuration field to set (as documented by the target component(s)).&nbsp; The full path to the target field(s) is thus</p><blockquote><pre>{arg1,&quot;.&quot;,arg2,&quot;.&quot;,arg3}</pre></blockquote><p>uvmc_get_config- The 1st arg is the full path to the component target whose configuration value you want to get.&nbsp; The 2nd argument is empty.&nbsp; (The 2nd arg is there to match the prototype of the uvm_config_db::get method in UVM.)&nbsp; The 3rd argument is the name of the config field to get.&nbsp; If a configuration was set at the path {arg1,&rdquo;.&rdquo;,arg3}, then the 4th argument contains the value of that config field and &lsquo;true&rsquo; is returned, otherwise false.</p></div></div></div>




 <!--CONTENT index=1 -->
<div class="CClass"><div class=CTopic><h2 class=CTitle><a name="prod_cfg" href="../../../uvmc/examples/commands/ex_config.cpp">prod_cfg</a></h2><div class=CBody><p>The <i>prod_cfg</i> class is the configuration object we&rsquo;ll be sending to the producer component on the SV side.&nbsp; It dictates the address range, data array length ranges, and the maximum number of transactions to produce.&nbsp; We use the <a href="../../src/connect/sc/uvmc_macros-h.html#UVMC_UTILS" class=LGeneric id=link9 onMouseOver="ShowTip(event, 'tt5', 'link9')" onMouseOut="HideTip('tt5')">UVMC_UTILS</a> macro option to quickly define a UVMC converter for it.</p><blockquote><pre>// (begin inline source)
#include &quot;uvmc.h&quot;
#include &quot;uvmc_macros.h&quot;
using namespace uvmc;


class prod_cfg {
  public:
  int min_addr;
  int max_addr;
  int min_data_len;
  int max_data_len;
  int max_trans;
};

UVMC_UTILS_5(prod_cfg,min_addr,max_addr,
             min_data_len,max_data_len,max_trans)</pre></blockquote></div></div></div>




 <!--CONTENT index=2 -->
<div class="CClass"><div class=CTopic><h2 class=CTitle><a name="top" href="../../../uvmc/examples/commands/ex_config.cpp">top</a></h2>

<!--START_ND_SUMMARY index=2-->
<div class=Summary><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=2 -->

<tr class="SClass"><td colspan=2 class=SEntry><a name="topSummary"  href="#top">top</a></td></tr>
<tr class=SMain><td colspan=2 class=SWideDescription>Our top-level SC module does the following</td></tr>
  <!-- index=3 -->

<tr class="SGroup SIndent1"><td class=SEntry><a name="top.MethodsSummary"  href="#top.Methods">Methods</a></td><td class=SDescription></td></tr>
  <!-- index=4 -->

<tr class="SMethod SIndent2"><td class=SEntry><a name="top.show_uvm_configSummary"  href="#top.show_uvm_config">show_uvm_config</a></td><td class=SDescription>The <i>show_uvm_config</i> thread will perform a set and get config operation on an integral, string, and object type. </td></tr></table></div></div><!--END_ND_SUMMARY-->
<div class=CBody><p>Our top-level SC module does the following</p><ul><li>Creates an instance of a generic <a href="../converters/consumer-cpp.html#consumer" class=LClass >consumer</a>.&nbsp; The consumer merely prints the transactions it receives side and sends them out its analysis port.</li><li>Spawn a thread function, <i>show_uvm_config</i></li><li>Register the consumer&rsquo;s ports for UVMC connection.</li></ul><p>The <i>show_uvm_config</i> thread will perform a set and get config operation on an integral, string, and object type.&nbsp; The object we use, <a href="#prod_cfg" class=LClass id=link10 onMouseOver="ShowTip(event, 'tt7', 'link10')" onMouseOut="HideTip('tt7')">prod_cfg</a>, configures in one go the SV-side producer with max transaction count and constraints on address and data array length.</p><p>Note the use of the UVM_INFO and UVM_ERROR macros, which issue reports to UVM for filtering, formatting, and display.</p><blockquote><pre>#include &lt;string&gt;
#include &lt;iostream&gt;
#include &quot;systemc.h&quot;
#include &quot;tlm.h&quot;
#include &quot;uvmc.h&quot;

using namespace std;
using namespace sc_core;
using namespace tlm;
using namespace uvmc;

#include &quot;consumer.cpp&quot;


SC_MODULE(top)
{
  consumer cons;

  SC_CTOR(top) : cons(&quot;consumer&quot;) {
    SC_THREAD(show_uvm_config);
    uvmc_connect(cons.in,&quot;foo&quot;);
    uvmc_connect(cons.analysis_out,&quot;bar&quot;);
  }

  void show_uvm_config();

};</pre></blockquote></div></div></div>




 <!--CONTENT index=3 -->
<div class="CGroup"><div class=CTopic><h3 class=CTitle><a name="top.Methods" href="../../../uvmc/examples/commands/ex_config.cpp">Methods</a></h3></div></div>




 <!--CONTENT index=4 -->
<div class="CMethod"><div class=CTopic><h3 class=CTitle><a name="top.show_uvm_config" href="../../../uvmc/examples/commands/ex_config.cpp">show_uvm_config</a></h3><div class=CBody><p>The <i>show_uvm_config</i> thread will perform a set and get config operation on an integral, string, and object type.&nbsp; The object we use, <a href="#prod_cfg" class=LClass id=link11 onMouseOver="ShowTip(event, 'tt7', 'link11')" onMouseOut="HideTip('tt7')">prod_cfg</a>, configures in one go the SV-side producer with max transaction count and constraints on address and data array length.</p><p>Note the use of the UVM_INFO and UVM_ERROR macros, which issue reports to UVM for filtering, formatting, and display.</p><blockquote><pre>void top::show_uvm_config()
{
  string s = &quot;Greetings from SystemC&quot;;
  uint64 i = 2;
  prod_cfg cfg;

  cfg.min_addr=0x100;
  cfg.max_addr=0x10f;
  cfg.min_data_len=1;
  cfg.max_data_len=8;
  cfg.max_trans=2;

  wait(SC_ZERO_TIME);


  UVMC_INFO(&quot;TOP/SET_CFG&quot;,
    &quot;Calling set_config_* to SV-side instance 'e.prod'&quot;,
    UVM_MEDIUM,&quot;&quot;);

  uvmc_set_config_int    (&quot;e.prod&quot;, &quot;&quot;, &quot;some_int&quot;, i);

  uvmc_set_config_string (&quot;&quot;, &quot;e.prod&quot;, &quot;some_string&quot;, s.c_str());

  uvmc_set_config_object (&quot;prod_cfg&quot;, &quot;e&quot;, &quot;prod&quot;, &quot;config&quot;, cfg);


  // Wait until the build phase. The SV side will have used get_config
  // to retreive our settings
  uvmc_wait_for_phase(&quot;build&quot;, UVM_PHASE_ENDED);

  i=0;
  s=&quot;&quot;;
  cfg.min_addr=0;
  cfg.max_addr=0;

  UVMC_INFO(&quot;TOP/GET_CFG&quot;, \
    &quot;Calling get_config_* from SV-side context 'e.prod'&quot;, \
    UVM_MEDIUM,&quot;&quot;);


  // Get and check our int, string, and object configuration
  if (uvmc_get_config_int (&quot;e.prod&quot;, &quot;&quot;, &quot;some_int&quot;, i))
    cout &lt;&lt; &quot;get_config_int : some_int=&quot; &lt;&lt; hex &lt;&lt; i &lt;&lt; endl;
  else
    UVMC_ERROR(&quot;GET_CFG_INT_FAIL&quot;, &quot;get_config_int failed&quot;,name());

  if (uvmc_get_config_string (&quot;e.prod&quot;, &quot;&quot;, &quot;some_string&quot;, s))
    cout &lt;&lt; &quot;get_config_string: some_string=&quot; &lt;&lt; s &lt;&lt; endl;
  else
    UVMC_ERROR(&quot;GET_CFG_STR_FAIL&quot;, &quot;get_config_string failed&quot;,name());

  if (uvmc_get_config_object (&quot;prod_cfg&quot;, &quot;e.prod&quot;, &quot;&quot;, &quot;config&quot;, cfg))
    cout &lt;&lt; &quot;get_config_object: config = &quot; &lt;&lt; cfg &lt;&lt; endl;
  else
    UVMC_ERROR(&quot;GET_CFG_OBJ_FAIL&quot;, &quot;get_config_object failed&quot;,name());
}</pre></blockquote></div></div></div>




 <!--CONTENT index=5 -->
<div class="CClass"><div class=CTopic><h2 class=CTitle><a name="SC_MAIN" href="../../../uvmc/examples/commands/ex_config.cpp">SC_MAIN</a></h2><div class=CBody><p>Creates an instance of our <a href="#top" class=LClass id=link13 onMouseOver="ShowTip(event, 'tt3', 'link13')" onMouseOut="HideTip('tt3')">top</a> module then calls <i>sc_start</i> to start SC simulation.</p><blockquote><pre>int sc_main(int argc, char* argv[])
{
  top t(&quot;top&quot;);
  sc_start();
  return 0;
}</pre></blockquote></div></div></div>

</div><!--Content-->



<!--START_ND_TOOLTIPS-->
<div class=CToolTip id="tt1"><div class=CGroup>Creates or updates a configuration setting for a field at a specified hierarchical context.</div></div><div class=CToolTip id="tt2"><div class=CGroup>Gets a configuration field <i>value</i> at a specified hierarchical <i>context</i>. </div></div><div class=CToolTip id="tt3"><div class=CClass>Our top-level SC module does the following</div></div><div class=CToolTip id="tt4"><div class=CSection>This chapter shows how to write converters for your transactions. </div></div><div class=CToolTip id="tt5"><div class=CGeneric>Generate both a converter specialization and output stream <i>operator&lt;&lt;</i> for the given transaction <i>TYPE</i>.</div></div><div class=CToolTip id="tt6"><div class=CGeneric>Generate a converter specialization of <i>uvmc_convert&lt;T&gt;</i> for the given transaction <i>TYPE</i>.</div></div><div class=CToolTip id="tt7"><div class=CClass>The <i>prod_cfg</i> class is the configuration object we&rsquo;ll be sending to the producer component on the SV side. </div></div><!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>