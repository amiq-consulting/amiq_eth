<html><head><title>SV Scoreboard</title><link rel="stylesheet" type="text/css" href="../../../../styles/main.css"><script language=JavaScript src="../../../../javascript/main.js"></script></head><body class="FramedContentPage" onLoad="NDOnLoad()"><script language=JavaScript><!--
if (browserType) {document.write("<div class=" + browserType + ">");if (browserVer) {document.write("<div class=" + browserVer + ">"); }}// --></script>

<!--  Generated by Natural Docs, version Development Release 01-12-2008 (1.35 base) -->
<!--  http://www.naturaldocs.org  -->

<!-- saved from url=(0026)http://www.naturaldocs.org --> 








 <!--TOP - START OF CONTENT-->
<div id=Content>


 <!--CONTENT index=0 -->
<div class="CClass"><div class=CTopic id=MainTopic><h1 class=CTitle></h1>

<!--START_ND_SUMMARY index=0-->
<div class=Summary><div class=SBorder><table border=0 cellspacing=0 cellpadding=0 class=STable>
  <!-- index=0 -->

<tr class="SClass"><td colspan=2 class=SEntry><a name="SV_Scoreboard"  href="../../../../uvmc/examples_ovm/connections/common/scoreboard.sv">SV Scoreboard</a></td></tr>
<tr class=SMain><td colspan=2 class=SWideDescription></td></tr>
  <!-- index=1 -->

<tr class="SGeneric SIndent1"><td class=SEntry><a name="SV_Scoreboard.DescriptionSummary"  href="#SV_Scoreboard.Description">Description</a></td><td class=SDescription>A simple SV scoreboard TLM model that collects expected transactions from its <i>expect_in</i> analysis imp and compares them with actual transactions received from its <i>actual_in</i> analysis imp.</td></tr></table></div></div><!--END_ND_SUMMARY-->
<div class=CBody></div></div></div>




 <!--CONTENT index=1 -->
<div class="CGeneric"><div class=CTopic><h3 class=CTitle><a name="SV_Scoreboard.Description" href="../../../../uvmc/examples_ovm/connections/common/scoreboard.sv">Description</a></h3><div class=CBody><p>A simple SV scoreboard TLM model that collects expected transactions from its <i>expect_in</i> analysis imp and compares them with actual transactions received from its <i>actual_in</i> analysis imp.</p><p>The model makes use of the <i>ovm_analysis_imp_decl</i> macros to allow the scoreboard to directly implement more than one analysis interface (the expected and the actual).</p><p>The <i>write_expect</i> implementation clones the incoming expect transaction because the producer may reuse the transaction object in subsequent iterations.&nbsp; It then prints the transaction before storing it in the internal queue.</p><p>The <i>write_actual</i> implementation also makes a clone of the incoming actual transaction.&nbsp; We do not do on-the-fly comparison because the corresponding expect transaction may not have arrived yet, and we can&rsquo;t hold onto the handle because the underlying object may be changed or reused before we&rsquo;ve had a chance to compare it.</p><p>This approach to scoreboard design affords several benefits over use of <i>tlm_fifo #(T)</i> on the expect side:</p><ul><li>consumes less memory.&nbsp; The queue is a primitive data type, whereas the tlm_fifo is composed of several class objects including the storage (mailbox) and the TLM exports, which are themselves composed of other objects.</li><li>the queue can be searched in cases where out-of-order arrival of actuals is permitted.&nbsp; The tlm_fifo can not.</li><li>the <i>write_expect</i> and <i>write_actual</i> methods provide a means of pre-qualifying the incoming transactions before putting them into their respective queues for later comparison.</li></ul><p>Although not done here, the scoreboard model might employ a timeout mechanism so it does not prevent the run phase from ending indefinitely.</p><p>While trivial in functionality, the model demonstrates use of TLM ports to facilitate external communication.</p><ul><li>Users of the model are not coupled to its internal implementation, using only the provided TLM analysis imps to communicate.</li><li>The model itself does not refer to anything outside its encapsulated implementation.&nbsp; It does not know nor care about what might analysis port.</li></ul>

<p align=center><a name="SV_Scoreboard.Description" href="../../../../uvmc/examples_ovm/connections/common/scoreboard.sv">.../examples_ovm/connections/common/scoreboard.sv</a></p></div>
<div class="SourceCode"><pre>

import ovm_pkg::*; 
`include "ovm_macros.svh"

`ovm_analysis_imp_decl(_expect)
`ovm_analysis_imp_decl(_actual)

class scoreboard extends ovm_component;

   packet qe[$];
   packet qa[$];

   ovm_analysis_imp_expect #(packet,scoreboard) expect_in;
   ovm_analysis_imp_actual #(packet,scoreboard) actual_in; 

   `ovm_component_utils(scoreboard)

   ovm_comparer comparer;
   bit raised_bit; 

   function new(string name, ovm_component parent=null);
      super.new(name,parent);
      expect_in = new("expect_in", this);
      actual_in = new("actual_in", this);
   endfunction : new

   function void build();
      if (comparer == null)
        comparer = new;
      comparer.show_max = 100;
   endfunction

   virtual function void write_expect(packet t);
     packet t_copy;
     $cast(t_copy,t.clone());
     `ovm_info("SB/EXPECT/RECV",{"\n",t.sprint()},UVM_MEDIUM)
     qe.push_back(t_copy);
     if (!raised_bit) begin
       ovm_test_done.raise_objection(this);
       raised_bit = 1;
     end
   endfunction

   virtual function void write_actual(packet t);
     packet t_copy;
     $cast(t_copy,t.clone());
     `ovm_info("SB/ACTUAL/RECV",{"\n",t.sprint()},UVM_MEDIUM)
     qa.push_back(t_copy);
     if (!raised_bit) begin
       ovm_test_done.raise_objection(this);
       raised_bit = 1;
     end
   endfunction

   virtual task run();
     packet e,a;

     // wait for both sides to deliver
     forever begin
       @(qa.size() && qe.size());

       e = qe.pop_front();
       a = qa.pop_front();

       if (!a.compare(e))
         `ovm_error("SB/MISCOMPARE",
           $sformatf("%m: There were %0d miscompares:\nexpect=%s\nactual=%s",
             comparer.result,e.sprint(),a.sprint()))
     
       if (raised_bit && !qa.size() && !qe.size()) begin
         ovm_test_done.drop_objection(this);
         raised_bit = 0;
       end
     
     end

   endtask

endclass
</pre></div>
</div></div>

</div><!--Content-->



<!--START_ND_TOOLTIPS-->
<!--END_ND_TOOLTIPS-->

<script language=JavaScript><!--
if (browserType) {if (browserVer) {document.write("</div>"); }document.write("</div>");}// --></script></body></html>